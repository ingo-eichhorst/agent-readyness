---
phase: 16-analyzer-reorganization
plan: 02
type: execute
wave: 2
depends_on: ["16-01"]
files_modified:
  - internal/analyzer/c1_code_quality/analyzer.go
  - internal/analyzer/c1_code_quality/codehealth.go
  - internal/analyzer/c1_code_quality/python.go
  - internal/analyzer/c1_code_quality/typescript.go
  - internal/analyzer/c1_code_quality/codehealth_test.go
  - internal/analyzer/c1_code_quality/python_test.go
  - internal/analyzer/c1_code_quality/typescript_test.go
  - internal/analyzer/c2_semantics/analyzer.go
  - internal/analyzer/c2_semantics/semantics.go
  - internal/analyzer/c2_semantics/go.go
  - internal/analyzer/c2_semantics/python.go
  - internal/analyzer/c2_semantics/typescript.go
  - internal/analyzer/c2_semantics/go_test.go
  - internal/analyzer/c2_semantics/python_test.go
  - internal/analyzer/c2_semantics/typescript_test.go
  - internal/analyzer/c3_architecture/analyzer.go
  - internal/analyzer/c3_architecture/architecture.go
  - internal/analyzer/c3_architecture/python.go
  - internal/analyzer/c3_architecture/typescript.go
  - internal/analyzer/c3_architecture/architecture_test.go
  - internal/analyzer/c3_architecture/python_test.go
  - internal/analyzer/c3_architecture/typescript_test.go
  - internal/analyzer/c4_documentation/analyzer.go
  - internal/analyzer/c4_documentation/documentation.go
  - internal/analyzer/c4_documentation/documentation_test.go
  - internal/analyzer/c5_temporal/analyzer.go
  - internal/analyzer/c5_temporal/temporal.go
  - internal/analyzer/c5_temporal/temporal_test.go
  - internal/analyzer/c6_testing/analyzer.go
  - internal/analyzer/c6_testing/testing.go
  - internal/analyzer/c6_testing/python.go
  - internal/analyzer/c6_testing/typescript.go
  - internal/analyzer/c6_testing/testing_test.go
  - internal/analyzer/c6_testing/python_test.go
  - internal/analyzer/c6_testing/typescript_test.go
  - internal/analyzer/c7_agent/analyzer.go
  - internal/analyzer/c7_agent/agent.go
  - internal/analyzer/c7_agent/agent_test.go
autonomous: true

must_haves:
  truths:
    - "All analyzer files moved to category subdirectories"
    - "All import paths work correctly"
    - "All tests pass after reorganization"
    - "Pipeline imports analyzer package unchanged"
  artifacts:
    - path: "internal/analyzer/c1_code_quality/analyzer.go"
      provides: "C1Analyzer type and NewC1Analyzer constructor"
      exports: ["C1Analyzer", "NewC1Analyzer"]
    - path: "internal/analyzer/c2_semantics/analyzer.go"
      provides: "C2Analyzer type and NewC2Analyzer constructor"
      exports: ["C2Analyzer", "NewC2Analyzer"]
    - path: "internal/analyzer/c7_agent/analyzer.go"
      provides: "C7Analyzer type and NewC7Analyzer constructor"
      exports: ["C7Analyzer", "NewC7Analyzer"]
  key_links:
    - from: "internal/pipeline/pipeline.go"
      to: "internal/analyzer"
      via: "import unchanged"
      pattern: '"github.com/ingo/agent-readyness/internal/analyzer"'
    - from: "internal/analyzer/c1_code_quality/python.go"
      to: "internal/analyzer"
      via: "shared utilities import"
      pattern: 'analyzer\.(WalkTree|NodeText)'
---

<objective>
Move all analyzer files to their category subdirectories, update package declarations and imports, and verify the entire codebase still builds and tests pass.

Purpose: Complete the reorganization so each category has its own package while maintaining backward compatibility through root-level re-exports.
Output: All 31 analyzer files reorganized into 7 category subdirectories, all tests passing.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-analyzer-reorganization/16-RESEARCH.md
@.planning/phases/16-analyzer-reorganization/16-01-SUMMARY.md

# Root-level files from Plan 01
@internal/analyzer/shared.go
@internal/analyzer/analyzer.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Move C1-C3 category files</name>
  <files>
    internal/analyzer/c1_code_quality/analyzer.go
    internal/analyzer/c1_code_quality/codehealth.go
    internal/analyzer/c1_code_quality/python.go
    internal/analyzer/c1_code_quality/typescript.go
    internal/analyzer/c1_code_quality/codehealth_test.go
    internal/analyzer/c1_code_quality/python_test.go
    internal/analyzer/c1_code_quality/typescript_test.go
    internal/analyzer/c2_semantics/analyzer.go
    internal/analyzer/c2_semantics/semantics.go
    internal/analyzer/c2_semantics/go.go
    internal/analyzer/c2_semantics/python.go
    internal/analyzer/c2_semantics/typescript.go
    internal/analyzer/c2_semantics/go_test.go
    internal/analyzer/c2_semantics/python_test.go
    internal/analyzer/c2_semantics/typescript_test.go
    internal/analyzer/c3_architecture/analyzer.go
    internal/analyzer/c3_architecture/architecture.go
    internal/analyzer/c3_architecture/python.go
    internal/analyzer/c3_architecture/typescript.go
    internal/analyzer/c3_architecture/architecture_test.go
    internal/analyzer/c3_architecture/python_test.go
    internal/analyzer/c3_architecture/typescript_test.go
  </files>
  <action>
For each category C1, C2, C3:

**File Mapping (drop c{N}_ prefix):**
- c1_codehealth.go -> c1_code_quality/codehealth.go
- c1_python.go -> c1_code_quality/python.go
- c1_typescript.go -> c1_code_quality/typescript.go
- c1_codehealth_test.go -> c1_code_quality/codehealth_test.go
- c1_python_test.go -> c1_code_quality/python_test.go
- c1_typescript_test.go -> c1_code_quality/typescript_test.go
- c2_semantics.go -> c2_semantics/semantics.go (this is the dispatcher)
- c2_go.go -> c2_semantics/go.go
- c2_python.go -> c2_semantics/python.go
- c2_typescript.go -> c2_semantics/typescript.go
- (tests follow same pattern)
- c3_architecture.go -> c3_architecture/architecture.go
- c3_python.go -> c3_architecture/python.go
- c3_typescript.go -> c3_architecture/typescript.go
- (tests follow same pattern)

**For each moved file:**
1. Change package declaration from `package analyzer` to `package c1` (or c2, c3)
2. Update imports:
   - Add `"github.com/ingo/agent-readyness/internal/analyzer"` for shared utilities
   - Replace local calls: `walkTree` -> `analyzer.WalkTree`, `nodeText` -> `analyzer.NodeText`, `countLines` -> `analyzer.CountLines`
   - Replace `BuildImportGraph` -> `analyzer.BuildImportGraph`, `ImportGraph` -> `analyzer.ImportGraph`
3. For C2: Remove the duplicate walkTree, nodeText, countLines definitions from python.go (they're now in shared.go)

**Create analyzer.go entry point for each category:**
Each category needs an analyzer.go that:
- Re-exports the main analyzer type and constructor
- Has package c1/c2/c3

Example for c1_code_quality/analyzer.go:
```go
package c1

// C1Analyzer and NewC1Analyzer are defined in codehealth.go
// This file exists for package organization clarity
```

Actually, the existing c{N}_{main}.go files already contain the analyzer types. Just ensure the type and constructor are exported (they already are - C1Analyzer, NewC1Analyzer).

**Filter function handling (per RESEARCH.md):**
- pyFilterSourceFiles and tsFilterSourceFiles are used by C1 and C3
- Duplicate these small functions in both c1 and c3 packages (avoid cross-category import)
- They're ~20 lines each, duplication is acceptable

Delete original files from root after successful move.
  </action>
  <verify>
`go build ./internal/analyzer/c1_code_quality/... ./internal/analyzer/c2_semantics/... ./internal/analyzer/c3_architecture/...` succeeds
  </verify>
  <done>
C1, C2, C3 files moved to subdirectories. Package declarations updated. Shared utility calls use analyzer.* prefix. Original files deleted from root.
  </done>
</task>

<task type="auto">
  <name>Task 2: Move C4-C7 category files</name>
  <files>
    internal/analyzer/c4_documentation/analyzer.go
    internal/analyzer/c4_documentation/documentation.go
    internal/analyzer/c4_documentation/documentation_test.go
    internal/analyzer/c5_temporal/analyzer.go
    internal/analyzer/c5_temporal/temporal.go
    internal/analyzer/c5_temporal/temporal_test.go
    internal/analyzer/c6_testing/analyzer.go
    internal/analyzer/c6_testing/testing.go
    internal/analyzer/c6_testing/python.go
    internal/analyzer/c6_testing/typescript.go
    internal/analyzer/c6_testing/testing_test.go
    internal/analyzer/c6_testing/python_test.go
    internal/analyzer/c6_testing/typescript_test.go
    internal/analyzer/c7_agent/analyzer.go
    internal/analyzer/c7_agent/agent.go
    internal/analyzer/c7_agent/agent_test.go
  </files>
  <action>
For each category C4, C5, C6, C7:

**File Mapping:**
- c4_documentation.go -> c4_documentation/documentation.go
- c4_documentation_test.go -> c4_documentation/documentation_test.go
- c5_temporal.go -> c5_temporal/temporal.go
- c5_temporal_test.go -> c5_temporal/temporal_test.go
- c6_testing.go -> c6_testing/testing.go
- c6_python.go -> c6_testing/python.go
- c6_typescript.go -> c6_testing/typescript.go
- (tests follow same pattern)
- c7_agent.go -> c7_agent/agent.go
- c7_agent_test.go -> c7_agent/agent_test.go

**For each moved file:**
1. Change package declaration to `package c4`, `package c5`, `package c6`, or `package c7`
2. Update imports for shared utilities (same pattern as Task 1)
3. C6 uses walkTree/nodeText - update to analyzer.WalkTree/analyzer.NodeText

**Note on C6 filter functions:**
- C6 also has pyFilterSourceFiles/tsFilterSourceFiles usage
- Duplicate from C1 if needed, or C6 may have its own copies

Delete original files from root after successful move.
  </action>
  <verify>
`go build ./internal/analyzer/c4_documentation/... ./internal/analyzer/c5_temporal/... ./internal/analyzer/c6_testing/... ./internal/analyzer/c7_agent/...` succeeds
  </verify>
  <done>
C4, C5, C6, C7 files moved to subdirectories. Package declarations updated. Original files deleted from root.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify full build and test suite</name>
  <files>None (verification only)</files>
  <action>
Run comprehensive verification:

1. Full build: `go build ./...`
   - Verifies all imports resolve
   - Verifies analyzer.go re-exports work
   - Verifies pipeline.go still compiles unchanged

2. Full test suite: `go test ./...`
   - All 100+ tests must pass
   - Pay attention to any test failures in analyzer packages

3. Verify no old files remain: `ls internal/analyzer/*.go`
   - Should only show: analyzer.go, shared.go
   - All c{N}_*.go files should be gone

4. Run `go mod tidy` to clean up any import changes

If any failures:
- Check import paths
- Verify type aliases use `=` (type T = pkg.T)
- Verify shared utility calls use analyzer.* prefix
- Check for missing filter function duplicates
  </action>
  <verify>
`go build ./...` exits 0
`go test ./...` shows all tests pass
`ls internal/analyzer/*.go` shows only analyzer.go and shared.go
  </verify>
  <done>
Full codebase builds successfully. All tests pass. No old analyzer files remain at root level. Reorganization complete.
  </done>
</task>

</tasks>

<verification>
1. `go build ./...` succeeds
2. `go test ./...` - all tests pass
3. `ls internal/analyzer/` shows: analyzer.go, shared.go, and 7 subdirectories
4. `ls internal/analyzer/c1_code_quality/` shows: codehealth.go, python.go, typescript.go, and their tests
5. `grep -r "package analyzer" internal/analyzer/` only matches root-level files
6. `grep "analyzer.NewC1Analyzer" internal/pipeline/pipeline.go` still works (backward compat)
</verification>

<success_criteria>
- All 31 original analyzer files removed from root
- All files reorganized into 7 category subdirectories
- Package declarations updated (c1, c2, ..., c7)
- Shared utility imports use analyzer.* prefix
- `go build ./...` succeeds
- `go test ./...` all tests pass
- pipeline.go unchanged (imports analyzer, uses NewCxAnalyzer)
</success_criteria>

<output>
After completion, create `.planning/phases/16-analyzer-reorganization/16-02-SUMMARY.md`
</output>
