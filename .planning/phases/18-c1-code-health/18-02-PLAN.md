---
phase: 18-c1-code-health
plan: 02
type: execute
wave: 2
depends_on: ["01"]
files_modified:
  - internal/output/descriptions.go
  - internal/output/citations.go
autonomous: true

must_haves:
  truths:
    - "All 6 C1 metrics have inline citations (Author, Year) in their descriptions"
    - "Each C1 metric has at least 1 foundational (pre-2021) and 1 AI-era (2021+) citation"
    - "C1 References section in citations.go contains complete entries for all cited sources"
    - "Every quantified claim in C1 metric descriptions has explicit source attribution"
    - "All citation URLs are verified accessible"
  artifacts:
    - path: "internal/output/descriptions.go"
      provides: "C1 metric descriptions with inline citations"
      contains: "span class=\"citation\""
    - path: "internal/output/citations.go"
      provides: "C1 reference entries"
      contains: "Category:    \"C1\""
  key_links:
    - from: "internal/output/descriptions.go"
      to: "internal/output/citations.go"
      via: "Author names match between inline and reference"
      pattern: "(McCabe|Fowler|Borg|Martin|Parnas|Chowdhury)"
---

<objective>
Add research-backed citations to all 6 C1 Code Health metrics using sources verified in 18-RESEARCH.md.

Purpose: Transform C1 metric descriptions from assertions into evidence-based claims that engineering leaders can verify.
Output: Updated `descriptions.go` with inline citations and `citations.go` with complete reference entries for all C1 sources.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/18-c1-code-health/18-CONTEXT.md
@.planning/phases/18-c1-code-health/18-RESEARCH.md
@.planning/phases/18-c1-code-health/18-01-SUMMARY.md
@internal/output/descriptions.go
@internal/output/citations.go
@docs/CITATION-GUIDE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update C1 metric descriptions with citations</name>
  <files>internal/output/descriptions.go</files>
  <action>
Update the 6 C1 metric descriptions in `descriptions.go` to add/enhance inline citations. Follow the citation standards established in `docs/CITATION-GUIDE.md`. Use `<span class="citation">(Author, Year)</span>` format. Reference the verified sources from 18-RESEARCH.md.

**complexity_avg** (already has good citations - minor cleanup if needed):
- Keep: McCabe (1976), Fowler et al. (1999), Borg et al. (2026)
- Ensure: Consistent formatting with `<span class="citation">` wrapper

**func_length_avg** (needs citations):
- Brief: Add key citation reference to "under 25 lines" claim
- Research Evidence section: Add citations for:
  - Fowler et al. (1999) - Long Method code smell, refactoring target
  - Chowdhury et al. (2022) - 24 SLOC threshold for Java methods (empirical study)
  - Borg et al. (2026) - AI agent performance on function length
- Update thresholds to reference research where applicable

**file_size_avg** (needs citations):
- Brief: Add key citation to "under 300 lines" guidance
- Research Evidence section: Add citations for:
  - Parnas (1972) - Module decomposition principles
  - Gamma et al. (1994) - Design patterns, cohesion, module design
  - Borg et al. (2026) - AI agent performance

**afferent_coupling_avg** (needs citations):
- Brief: Can reference coupling literature
- Research Evidence section: Add citations for:
  - Parnas (1972) - Information hiding, module interfaces
  - Martin (2003) - Stable Dependencies Principle, Ca metric
  - Borg et al. (2026) - AI agent performance on coupled code

**efferent_coupling_avg** (already has Martin 2003 - enhance):
- Brief: Confirm Martin reference is properly cited
- Research Evidence section: Add/enhance citations for:
  - Martin (2003) - Stable Abstractions Principle, Ce metric
  - Martin (2017) - Clean Architecture (optional, same principles)
  - Borg et al. (2026) - AI agent performance

**duplication_rate** (needs citations):
- Brief: Add key citation to duplication claims
- Research Evidence section: Add citations for:
  - Fowler et al. (1999) - Duplicated Code smell, DRY principle
  - Borg et al. (2026) - AI agent performance on duplicated code
- Note: GitClear 2025 is low-confidence, use Fowler as primary

**Citation format rules (from docs/CITATION-GUIDE.md):**
- Use `<span class="citation">(Author et al., Year)</span>` for 3+ authors
- Use `<span class="citation">(Author & Author, Year)</span>` for 2 authors
- Place primary citations in Research Evidence section
- Keep Brief descriptions concise (key citation only if needed)
- Ensure all quantified claims (36-44%, under 25 lines, etc.) have citations
  </action>
  <verify>
- `grep -c 'span class="citation"' internal/output/descriptions.go` shows increased citation count
- Each C1 metric (complexity_avg, func_length_avg, file_size_avg, afferent_coupling_avg, efferent_coupling_avg, duplication_rate) has at least 2 inline citations
- All citations use consistent `<span class="citation">(Author, Year)</span>` format
- `go build ./...` passes (no syntax errors)
  </verify>
  <done>
All 6 C1 metrics have inline citations with (Author, Year) format, including at least 1 foundational and 1 AI-era source per metric.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add C1 reference entries to citations.go</name>
  <files>internal/output/citations.go</files>
  <action>
Add new Citation entries to `researchCitations` slice in `citations.go` for sources not already present. Existing C1 entries: Fowler (1999), McCabe (1976), Borg (2026).

**Add these new C1 entries:**

1. Parnas (1972) - Module decomposition:
```go
{
    Category:    "C1",
    Title:       "On the Criteria To Be Used in Decomposing Systems into Modules",
    Authors:     "Parnas",
    Year:        1972,
    URL:         "https://dl.acm.org/doi/10.1145/361598.361623",
    Description: "Module decomposition principles and information hiding",
},
```

2. Martin (2003) - Coupling metrics:
```go
{
    Category:    "C1",
    Title:       "Agile Software Development: Principles, Patterns, and Practices",
    Authors:     "Martin",
    Year:        2003,
    URL:         "https://www.pearson.com/en-us/subject-catalog/p/agile-software-development-principles-patterns-and-practices/P200000009452",
    Description: "Coupling metrics (Ca, Ce) and Stable Dependencies Principle",
},
```

3. Gamma et al. (1994) - Design patterns:
```go
{
    Category:    "C1",
    Title:       "Design Patterns: Elements of Reusable Object-Oriented Software",
    Authors:     "Gamma et al.",
    Year:        1994,
    URL:         "https://en.wikipedia.org/wiki/Design_Patterns",
    Description: "Cohesion, module design, and reusable patterns",
},
```

4. Chowdhury et al. (2022) - Method size:
```go
{
    Category:    "C1",
    Title:       "An Empirical Study on Maintainable Method Size in Java",
    Authors:     "Chowdhury et al.",
    Year:        2022,
    URL:         "https://arxiv.org/abs/2205.01842",
    Description: "Methods under 24 SLOC are less maintenance-prone",
},
```

**Note:** Gamma et al. (1994) already exists under C3. Either:
- Add duplicate entry for C1 (allowed - same source supports multiple categories), OR
- Reference the C3 entry and note cross-category applicability in descriptions.go

Prefer adding duplicate C1 entry for clarity - each category should be self-contained in the References section.

**Verify existing entries:**
- McCabe (1976) URL: `https://ieeexplore.ieee.org/document/1702388` (confirm accessible)
- Fowler (1999) URL: `https://martinfowler.com/books/refactoring.html` (confirm accessible)
- Borg (2026) URL: `https://arxiv.org/abs/2601.02200` (confirm accessible)
  </action>
  <verify>
- `grep -c 'Category:    "C1"' internal/output/citations.go` shows 7+ C1 entries
- `go build ./...` passes
- New entries have valid URLs (test with `curl -I [URL]` returning 200 or 301/302 redirect)
  </verify>
  <done>
C1 References section contains complete citation entries for all sources cited in C1 metric descriptions.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify all C1 citation URLs are accessible</name>
  <files>None (verification only)</files>
  <action>
Verify all C1 citation URLs are accessible using curl. Run the following checks:

```bash
# McCabe (1976) - IEEE
curl -I "https://ieeexplore.ieee.org/document/1702388" 2>/dev/null | head -1

# Fowler et al. (1999) - Martin Fowler site
curl -I "https://martinfowler.com/books/refactoring.html" 2>/dev/null | head -1

# Borg et al. (2026) - ArXiv
curl -I "https://arxiv.org/abs/2601.02200" 2>/dev/null | head -1

# Parnas (1972) - ACM
curl -I "https://dl.acm.org/doi/10.1145/361598.361623" 2>/dev/null | head -1

# Martin (2003) - Pearson
curl -I "https://www.pearson.com/en-us/subject-catalog/p/agile-software-development-principles-patterns-and-practices/P200000009452" 2>/dev/null | head -1

# Gamma et al. (1994) - Wikipedia
curl -I "https://en.wikipedia.org/wiki/Design_Patterns" 2>/dev/null | head -1

# Chowdhury et al. (2022) - ArXiv
curl -I "https://arxiv.org/abs/2205.01842" 2>/dev/null | head -1
```

Expected results: HTTP 200 OK, or 301/302 redirects (which resolve to content).

If any URL fails:
1. Try DOI resolver: `https://doi.org/10.xxxx/xxxxx`
2. Find alternative URL (official publisher, arXiv, author site)
3. Update citations.go with working URL
4. Document any paywall status in citation Description field
  </action>
  <verify>
- All 7 C1 citation URLs return HTTP 200 or valid redirect
- No 404, 403, or timeout errors
- Document results in summary
  </verify>
  <done>
All C1 citation URLs verified accessible. Any issues resolved with alternative URLs or documented as paywalled with sufficient metadata for library lookup.
  </done>
</task>

</tasks>

<verification>
- [ ] `go build ./...` passes with no errors
- [ ] `go test ./internal/output/...` passes (if tests exist)
- [ ] All 6 C1 metrics have inline citations in descriptions.go
- [ ] citations.go has 7+ C1 category entries
- [ ] All URLs verified accessible via curl
- [ ] Citation format consistent: `<span class="citation">(Author, Year)</span>`
</verification>

<success_criteria>
- All 6 C1 metrics have inline citations (Author, Year) in their descriptions
- Each C1 metric has at least 1 foundational (pre-2021) and 1 AI-era (2021+) citation
- C1 References section contains complete entries for: McCabe (1976), Fowler (1999), Parnas (1972), Martin (2003), Gamma (1994), Chowdhury (2022), Borg (2026)
- Every quantified claim (36-44%, under 25 lines, under 300 lines, etc.) has explicit source attribution
- All citation URLs verified accessible
</success_criteria>

<output>
After completion, create `.planning/phases/18-c1-code-health/18-02-SUMMARY.md`
</output>
