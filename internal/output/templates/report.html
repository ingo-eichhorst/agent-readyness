<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="ars-report-version" content="1.0">
    <title>ARS Report: {{.ProjectName}}</title>
    <style>{{.InlineCSS}}</style>
</head>
<body>
    <header>
        <h1>Agent Readiness Score</h1>
        <p class="project-name">{{.ProjectName}}</p>
        <div class="composite-score">
            <span class="score score-{{.TierClass}}">{{printf "%.1f" .Composite}}</span>
            <span class="tier tier-{{.TierClass}}">{{.Tier}}</span>
        </div>
        <p class="generated-at">Generated: {{.GeneratedAt}}</p>
    </header>

    <section class="radar-chart">
        {{.RadarChartSVG}}
    </section>

    {{if .BadgeURL}}
    <section class="badge-section">
        <h2>README Badge</h2>
        <p>Add this badge to your README to show your project's agent readiness score:</p>
        <div class="badge-preview">
            <img src="{{.BadgeURL}}" alt="ARS Badge">
        </div>
        <div class="badge-code">
            <code id="badge-markdown">{{.BadgeMarkdown}}</code>
            <button onclick="navigator.clipboard.writeText(document.getElementById('badge-markdown').textContent)">Copy</button>
        </div>
    </section>
    {{end}}

    <section class="categories">
        <div class="expand-controls">
            <button onclick="document.querySelectorAll('details.metric-details').forEach(d => d.open = true)">Expand All</button>
            <button onclick="document.querySelectorAll('details.metric-details').forEach(d => d.open = false)">Collapse All</button>
        </div>
        {{range .Categories}}
        <div class="category">
            <h2>{{.DisplayName}} <span class="cat-score score-{{.ScoreClass}}">{{printf "%.1f" .Score}}/10</span></h2>
            <table class="metric-table">
                <thead>
                    <tr><th>Metric</th><th>Value</th><th>Score</th><th>Weight</th></tr>
                </thead>
                <tbody>
                    {{range .SubScores}}
                    <tr>
                        <td class="metric-cell">
                            <details class="metric-details"{{if .ShouldExpand}} open{{end}}>
                                <summary>
                                    <span class="metric-name">{{.DisplayName}}</span>
                                    <span class="chevron"></span>
                                </summary>
                                {{if .BriefDescription}}
                                <div class="metric-brief">{{.BriefDescription}}</div>
                                {{end}}
                                {{if .DetailedDescription}}
                                <div class="metric-detailed">{{.DetailedDescription}}</div>
                                {{end}}
                            </details>
                        </td>
                        <td>{{.FormattedValue}}</td>
                        <td class="score-cell score-{{.ScoreClass}}">{{printf "%.1f" .Score}}</td>
                        <td>{{printf "%.0f" .WeightPct}}%</td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
            {{if .ImpactDescription}}<p class="impact">{{.ImpactDescription}}</p>{{end}}
        </div>
        {{end}}
    </section>

    {{if .HasTrend}}
    <section class="trends">
        <h2>Score Comparison</h2>
        {{.TrendChartSVG}}
    </section>
    {{end}}

    {{if .Recommendations}}
    <section class="recommendations">
        <h2>Top Recommendations</h2>
        {{range .Recommendations}}
        <div class="recommendation">
            <h3>{{.Rank}}. {{.Summary}}</h3>
            <p><strong>Impact:</strong> +{{printf "%.1f" .ScoreImprovement}} points</p>
            <p><strong>Effort:</strong> {{.Effort}}</p>
            <p><strong>Action:</strong> {{.Action}}</p>
        </div>
        {{end}}
    </section>
    {{end}}

    <footer>
        <h2>Research Citations</h2>
        <p>ARS metrics are grounded in software engineering research:</p>
        <ul class="citations">
            {{range .Citations}}
            <li><strong>{{.Category}}:</strong> <a href="{{.URL}}" target="_blank" rel="noopener">{{.Title}}</a> ({{.Authors}}, {{.Year}}) - {{.Description}}</li>
            {{end}}
        </ul>
        <p class="footer-note">Generated by ARS v{{.Version}}</p>
    </footer>
</body>
</html>
